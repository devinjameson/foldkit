@import 'tailwindcss';

@custom-variant dark (&:where(.dark, .dark *));
@custom-variant hover-capable {
  @media (hover: hover) {
    @slot;
  }
}

@theme {
  --color-gray-850: #131921;
}

:root {
  --header-height: 3.5rem;
  --mobile-toc-height: 2.75rem;
}

@media (min-width: theme(--breakpoint-md)) {
  :root {
    --header-height: 4.5rem;
  }
}

@media (min-width: theme(--breakpoint-xl)) {
  :root {
    --mobile-toc-height: 0rem;
  }
}

@layer base {
  html {
    color-scheme: light;
    scroll-padding-top: calc(
      var(--header-height) + var(--mobile-toc-height)
    );
  }

  html.dark {
    color-scheme: dark;
  }

  body {
    @apply text-base text-gray-800 dark:text-gray-300 bg-gray-100 dark:bg-gray-900;
  }

  pre {
    @apply pr-14 pl-[11px] py-4 rounded-lg overflow-x-auto;
  }

  pre code {
    @apply block;
  }

  pre code .line {
    @apply leading-6;
  }

  pre code .line[data-line]::before {
    content: attr(data-line);
    @apply inline-block mr-4 text-right text-gray-500 select-none border-r border-gray-600 pr-4;
  }

  pre[data-line-digits='1'] code .line[data-line]::before {
    @apply w-8;
  }

  pre[data-line-digits='2'] code .line[data-line]::before {
    @apply w-10;
  }

  pre[data-line-digits='3'] code .line[data-line]::before {
    @apply w-12;
  }
}

@layer components {
  .landing-section {
    @apply px-6 py-10 md:px-12 md:py-24 lg:px-20;
  }

  .landing-section + .landing-section {
    @apply border-t border-gray-200 dark:border-gray-800;
  }

  .landing-section-narrow {
    @apply max-w-5xl mx-auto;
  }

  .cta-primary {
    @apply inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-blue-600 text-white font-semibold text-base transition hover:bg-blue-700 active:bg-blue-800;
  }

  .cta-secondary {
    @apply inline-flex items-center gap-2 px-6 py-3 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white font-semibold text-base transition hover:bg-gray-200 hover:border-gray-400 dark:hover:bg-gray-800 dark:hover:border-gray-400;
  }

  .cta-gradient {
    @apply inline-flex items-center gap-2 px-6 py-3 rounded-lg font-semibold text-base transition relative;
    background: transparent;
    color: theme(--color-gray-900);
  }

  .cta-gradient::before {
    content: '';
    @apply absolute inset-0 rounded-lg;
    padding: 1px;
    background: linear-gradient(
      to right,
      theme(--color-blue-600),
      theme(--color-violet-600),
      theme(--color-blue-600)
    );
    mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    mask-composite: exclude;
  }

  .cta-gradient:hover {
    background: rgba(139, 92, 246, 0.05);
  }

  .dark .cta-gradient {
    color: white;
  }

  .dark .cta-gradient::before {
    background: linear-gradient(
      to right,
      theme(--color-blue-400),
      theme(--color-violet-400),
      theme(--color-blue-400)
    );
  }

  .dark .cta-gradient:hover {
    background: rgba(139, 92, 246, 0.1);
  }

  .landing-card {
    @apply rounded-xl bg-white border border-gray-200 dark:border-gray-700;
  }

  .demo-code-panel pre {
    @apply pr-4 py-3 text-sm leading-relaxed;
  }

  .demo-code-panel pre code .line {
    @apply transition-all duration-200 rounded-sm;
    border-left: 3px solid transparent;
    padding-left: 4px;
  }

  .demo-progress-bar {
    width: 0%;
    transition: none;
  }

  .demo-progress-bar-active {
    width: 100%;
    transition: width calc(var(--reset-duration) * 1s) linear;
  }

  /* Demo line highlights: message (emerald), update (amber), model (blue), command (violet) */
  .demo-code-panel[data-demo-phase='IncrementMessage']
    [data-line='14'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='24'],
  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='25'],
  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='26'],
  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='27'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='6'],
  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='7'],
  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='8'],
  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='9'],
  .demo-code-panel[data-demo-phase='IncrementModel']
    [data-line='10'] {
    @apply bg-blue-500/15;
    border-left-color: theme(--color-blue-400);
  }

  .demo-code-panel[data-demo-phase='ResetMessage'] [data-line='18'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='32'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='33'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='34'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='35'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='36'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='37'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .demo-code-panel[data-demo-phase='ResetCommand'] [data-line='34'],
  .demo-code-panel[data-demo-phase='ResetCommand'] [data-line='35'],
  .demo-code-panel[data-demo-phase='ResetCommand'] [data-line='36'] {
    @apply bg-violet-500/15;
    border-left-color: theme(--color-violet-400);
    animation: demo-pulse 1s ease-in-out infinite;
  }

  .demo-code-panel[data-demo-phase='ResetCommandMessage']
    [data-line='19'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='38'],
  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='39'],
  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='40'],
  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='41'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='6'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='7'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='8'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='9'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='10'] {
    @apply bg-blue-500/15;
    border-left-color: theme(--color-blue-400);
  }

  @keyframes demo-pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  .hero-dot-grid {
    background-image: radial-gradient(
      circle,
      theme(--color-gray-300) 1px,
      transparent 1px
    );
    background-size: 24px 24px;
  }

  .dark .hero-dot-grid {
    background-image: radial-gradient(
      circle,
      theme(--color-gray-800) 1px,
      transparent 1px
    );
  }

  .hero-gradient-text {
    @apply bg-clip-text text-transparent;
    background-image: linear-gradient(
      90deg,
      theme(--color-blue-600),
      theme(--color-violet-600),
      theme(--color-blue-600),
      theme(--color-violet-600),
      theme(--color-blue-600)
    );
    background-size: 200% 100%;
    animation: gradient-shift 8s linear infinite;
  }

  .dark .hero-gradient-text {
    background-image: linear-gradient(
      90deg,
      theme(--color-blue-400),
      theme(--color-violet-400),
      theme(--color-blue-400),
      theme(--color-violet-400),
      theme(--color-blue-400)
    );
  }

  @keyframes gradient-shift {
    0% {
      background-position: 0% 50%;
    }
    100% {
      background-position: 200% 50%;
    }
  }
}

@media (prefers-reduced-motion: reduce) {
  .hero-gradient-text {
    animation: none;
  }

  .demo-code-panel [data-line] {
    transition: none;
  }
}
