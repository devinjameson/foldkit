@import 'tailwindcss';

@custom-variant dark (&:where(.dark, .dark *));
@custom-variant hover-capable {
  @media (hover: hover) {
    @slot;
  }
}

@theme {
  --color-gray-850: #131921;
}

:root {
  --header-height: calc(3.5rem + env(safe-area-inset-top, 0px));
  --mobile-toc-height: 2.75rem;
}

@media (min-width: theme(--breakpoint-md)) {
  :root {
    --header-height: calc(4.5rem + env(safe-area-inset-top, 0px));
  }
}

@media (min-width: theme(--breakpoint-xl)) {
  :root {
    --mobile-toc-height: 0rem;
  }
}

@layer base {
  [tabindex='-1']:focus {
    outline: none;
  }

  html {
    color-scheme: light;
    scroll-padding-top: calc(
      var(--header-height) + var(--mobile-toc-height)
    );
  }

  html.dark {
    color-scheme: dark;
  }

  body {
    @apply text-base text-gray-800 dark:text-gray-300 bg-gray-100 dark:bg-gray-900;
  }

  pre {
    @apply pr-14 pl-[11px] py-4 rounded-lg overflow-x-auto;
  }

  pre code {
    @apply block;
  }

  pre code .line {
    @apply leading-6;
  }

  pre code .line[data-line]::before {
    content: attr(data-line);
    @apply inline-block mr-4 text-right text-gray-500 select-none border-r border-gray-600 pr-4;
  }

  pre[data-line-digits='1'] code .line[data-line]::before {
    @apply w-8;
  }

  pre[data-line-digits='2'] code .line[data-line]::before {
    @apply w-10;
  }

  pre[data-line-digits='3'] code .line[data-line]::before {
    @apply w-12;
  }
}

@layer components {
  .landing-section {
    @apply px-6 py-10 md:px-12 md:py-24 lg:px-20;
  }

  .landing-section + .landing-section {
    @apply border-t border-gray-200 dark:border-gray-800;
  }

  .landing-section-narrow {
    @apply max-w-5xl mx-auto;
  }

  .cta-primary {
    @apply inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-pink-600 dark:bg-pink-500 text-white font-semibold text-base transition hover:bg-pink-700 dark:hover:bg-pink-600 active:bg-pink-800 dark:active:bg-pink-700;
  }

  .cta-secondary {
    @apply inline-flex items-center gap-2 px-6 py-3 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white font-semibold text-base transition hover:bg-gray-200 hover:border-gray-400 dark:hover:bg-gray-800 dark:hover:border-gray-400;
  }

  .cta-gradient {
    @apply inline-flex items-center gap-2 px-6 py-3 rounded-lg font-semibold text-base transition relative;
    background: transparent;
    color: theme(--color-gray-900);
  }

  .cta-gradient::before {
    content: '';
    @apply absolute inset-0 rounded-lg;
    padding: 1px;
    background: theme(--color-pink-600);
    mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    mask-composite: exclude;
  }

  .cta-gradient:hover {
    background: rgba(219, 39, 119, 0.05);
  }

  .dark .cta-gradient {
    color: white;
  }

  .dark .cta-gradient::before {
    background: theme(--color-pink-500);
  }

  .dark .cta-gradient:hover {
    background: rgba(236, 72, 153, 0.1);
  }

  .landing-card {
    @apply rounded-xl bg-white border border-gray-200 dark:border-gray-700;
  }

  @media (min-width: theme(--breakpoint-lg)) {
    .demo-viewport-constraint {
      max-height: calc(100vh - var(--header-height) - 2rem);
      display: flex;
      flex-direction: column;
    }

    .demo-viewport-constraint > div {
      flex: 1;
      min-height: 0;
    }

    .demo-viewport-constraint [role='tabpanel'] {
      flex: 1;
      min-height: 0;
      display: flex;
      flex-direction: column;
    }

    .demo-viewport-constraint .demo-container {
      flex: 1;
      min-height: 0;
    }

    .demo-viewport-constraint .demo-code-panel,
    .demo-viewport-constraint .note-demo-code-panel {
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    .demo-viewport-constraint .demo-code-scroll {
      flex: 1;
      min-height: 0;
      overflow: auto;
    }
  }

  .demo-code-panel pre,
  .note-demo-code-panel pre {
    background: transparent !important;
    border-radius: 0;
  }

  .demo-code-panel pre code .line[data-line]::before,
  .note-demo-code-panel pre code .line[data-line]::before {
    @apply hidden;
  }

  .demo-code-panel pre {
    @apply pr-4 py-3 text-xs;
  }

  .demo-code-panel pre code .line {
    @apply transition-all duration-200 rounded-sm leading-5;
    border-left: 3px solid transparent;
    padding-left: 4px;
  }

  .demo-progress-bar {
    width: 0%;
    transition: none;
  }

  .demo-progress-bar-active {
    width: 100%;
    transition: width calc(var(--reset-duration) * 1s) linear;
  }

  /* Demo line highlights: message (emerald), update (amber), model (blue), command (violet) */
  .demo-code-panel[data-demo-phase='IncrementMessage']
    [data-line='11'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='21'],
  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='22'],
  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='23'],
  .demo-code-panel[data-demo-phase='IncrementUpdate']
    [data-line='24'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='3'],
  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='4'],
  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='5'],
  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='6'],
  .demo-code-panel[data-demo-phase='IncrementModel'] [data-line='7'] {
    @apply bg-blue-500/15;
    border-left-color: theme(--color-blue-400);
  }

  .demo-code-panel[data-demo-phase='ResetMessage'] [data-line='15'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='29'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='30'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='31'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='32'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='33'],
  .demo-code-panel[data-demo-phase='ResetUpdate'] [data-line='34'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .demo-code-panel[data-demo-phase='ResetCommand'] [data-line='31'],
  .demo-code-panel[data-demo-phase='ResetCommand'] [data-line='32'],
  .demo-code-panel[data-demo-phase='ResetCommand'] [data-line='33'] {
    @apply bg-violet-500/15;
    border-left-color: theme(--color-violet-400);
    animation: demo-pulse 1s ease-in-out infinite;
  }

  .demo-code-panel[data-demo-phase='ResetCommandMessage']
    [data-line='16'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='35'],
  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='36'],
  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='37'],
  .demo-code-panel[data-demo-phase='ResetCommandUpdate']
    [data-line='38'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='3'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='4'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='5'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='6'],
  .demo-code-panel[data-demo-phase='ResetModel'] [data-line='7'] {
    @apply bg-blue-500/15;
    border-left-color: theme(--color-blue-400);
  }

  /* Note player demo base styles */
  .note-demo-code-panel pre {
    @apply pr-4 py-3 text-xs;
  }

  .note-demo-code-panel pre code .line {
    @apply transition-all duration-200 rounded-sm leading-5;
    border-left: 3px solid transparent;
    padding-left: 4px;
  }

  /* Note player demo line highlights: message (emerald), update (amber), model (blue), command (violet) */
  .note-demo-code-panel[data-note-demo-phase='PlayMessage']
    [data-line='11'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .note-demo-code-panel[data-note-demo-phase='PauseMessage']
    [data-line='12'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .note-demo-code-panel[data-note-demo-phase='PlayUpdate']
    [data-line='20'],
  .note-demo-code-panel[data-note-demo-phase='PlayUpdate']
    [data-line='21'],
  .note-demo-code-panel[data-note-demo-phase='PlayUpdate']
    [data-line='22'],
  .note-demo-code-panel[data-note-demo-phase='PlayUpdate']
    [data-line='23'],
  .note-demo-code-panel[data-note-demo-phase='PlayUpdate']
    [data-line='24'],
  .note-demo-code-panel[data-note-demo-phase='PlayUpdate']
    [data-line='25'],
  .note-demo-code-panel[data-note-demo-phase='PlayUpdate']
    [data-line='26'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .note-demo-code-panel[data-note-demo-phase='PlayModel']
    [data-line='3'],
  .note-demo-code-panel[data-note-demo-phase='PlayModel']
    [data-line='4'],
  .note-demo-code-panel[data-note-demo-phase='PlayModel']
    [data-line='5'],
  .note-demo-code-panel[data-note-demo-phase='PlayModel']
    [data-line='6'],
  .note-demo-code-panel[data-note-demo-phase='PlayModel']
    [data-line='7'] {
    @apply bg-blue-500/15;
    border-left-color: theme(--color-blue-400);
  }

  .note-demo-code-panel[data-note-demo-phase='NoteMessage']
    [data-line='13'],
  .note-demo-code-panel[data-note-demo-phase='NoteMessage']
    [data-line='14'],
  .note-demo-code-panel[data-note-demo-phase='NoteMessage']
    [data-line='15'] {
    @apply bg-emerald-500/15;
    border-left-color: theme(--color-emerald-400);
  }

  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='34'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='35'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='36'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='37'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='38'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='39'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='40'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='41'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='42'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='43'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='44'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='45'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='46'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='47'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='48'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='49'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='50'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='51'],
  .note-demo-code-panel[data-note-demo-phase='NoteUpdate']
    [data-line='52'] {
    @apply bg-amber-500/15;
    border-left-color: theme(--color-amber-400);
  }

  .note-demo-code-panel[data-note-demo-phase='NoteModel']
    [data-line='3'],
  .note-demo-code-panel[data-note-demo-phase='NoteModel']
    [data-line='4'],
  .note-demo-code-panel[data-note-demo-phase='NoteModel']
    [data-line='5'],
  .note-demo-code-panel[data-note-demo-phase='NoteModel']
    [data-line='6'],
  .note-demo-code-panel[data-note-demo-phase='NoteModel']
    [data-line='7'] {
    @apply bg-blue-500/15;
    border-left-color: theme(--color-blue-400);
  }

  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='64'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='65'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='66'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='67'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='68'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='69'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='70'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='71'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='72'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='73'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='74'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='75'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='76'],
  .note-demo-code-panel[data-note-demo-phase='NoteCommand']
    [data-line='77'] {
    @apply bg-violet-500/15;
    border-left-color: theme(--color-violet-400);
  }

  @keyframes demo-pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }
}

@media (prefers-reduced-motion: reduce) {
  .demo-code-panel [data-line],
  .note-demo-code-panel [data-line] {
    transition: none;
  }
}
