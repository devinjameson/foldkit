import { Effect, Option } from 'effect'
import type { Command } from 'foldkit'
import { Task } from 'foldkit'

import { USERNAME_INPUT_ID } from '../../constant'
import { Message, NoOp } from './message'
import { EnterUsername, Model } from './model'

export type InitReturn = [Model, ReadonlyArray<Command<Message>>]

export const init = (): InitReturn => [
  {
    homeStep: EnterUsername({ username: '' }),
    formError: Option.none(),
  },
  [Task.focus(`#${USERNAME_INPUT_ID}`).pipe(Effect.ignore, Effect.as(NoOp()))],
]
